name: Build Flutter Android APK

on:
  push:
    branches:
      - main # أو اسم الفرع الرئيسي لمشروعك مثل master

jobs:
  build:
    runs-on: ubuntu-latest # سيتم تشغيل هذه المهمة على خادم Ubuntu

    steps:
      - name: Checkout code
        uses: actions/checkout@v3 # جلب الكود من المستودع

      - name: Set up JDK 11
        uses: actions/setup-java@v3
        with:
          distribution: 'temurin' # توزيعة Java
          java-version: '11'    # إصدار Java المطلوب لـ Flutter

      - name: Set up Flutter
        uses: subosito/flutter-action@v2 # إعداد Flutter SDK
        with:
          channel: 'stable' # أو 'beta', 'dev' حسب حاجتك
          # flutter-version: '3.x.x' # يمكنك تحديد إصدار معين إذا أردت

      - name: Get Flutter dependencies
        run: flutter pub get # تحميل الاعتماديات الخاصة بالمشروع

      - name: Build APK
        run: flutter build apk --release # بناء APK لإصدار الإنتاج
        # إذا أردت بناء APK للتصحيح (debug)، استخدم:
        # run: flutter build apk --debug

      - name: Upload APK
        uses: actions/upload-artifact@v3 # رفع ملف الـ APK كـ "artifact"
        with:
          name: release-apk # اسم الـ artifact الذي سيتم رفعه
          path: build/app/outputs/flutter-apk/app-release.apk # المسار إلى ملف الـ APK
          # إذا كنت تبني debug APK، المسار عادةً:
          # path: build/app/outputs/flutter-apk/app-debug.apk
